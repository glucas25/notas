<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta de Boletas - U.E.F. Juan Le贸n Mera</title>
    <link rel="stylesheet" href="styles.css">
    <script src="theme.js"></script>
</head>
<body>
    <!-- Bot贸n de acceso de administrador -->
    <button class="admin-access" onclick="openAdminModal()" title="Acceso Administrador">
        锔
    </button>

    <!-- Bot贸n de modo oscuro/claro -->
    <button class="theme-toggle" id="themeToggle" title="Cambiar modo claro/oscuro"></button>

    <!-- Modal de login administrativo -->
    <div class="modal-overlay" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3> Acceso Administrativo</h3>
                <p>Ingrese sus credenciales de administrador</p>
            </div>
            <form onsubmit="loginAdmin(event)">
                <div class="form-group">
                    <label for="adminUser">Usuario:</label>
                    <input type="text" id="adminUser" required>
                </div>
                <div class="form-group">
                    <label for="adminPass">Contrase帽a:</label>
                    <input type="password" id="adminPass" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-modal btn-secondary" onclick="closeAdminModal()">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-modal btn-primary">
                        Iniciar Sesi贸n
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <!-- Logo eliminado -->
            <div class="institution-name">Unidad Educativa Fiscal "Juan Le贸n Mera"</div>
            <h1> Consulta de Notas de Estudiantes</h1>
            <p>Primer Trimestre 2025</p>
        </div>

        <!-- Panel de administrador (oculto por defecto) -->
        <div class="admin-panel" id="adminPanel">
            <h3>
                 Panel Administrativo
                <button class="admin-logout" onclick="logoutAdmin()">Cerrar Sesi贸n</button>
                <button class="btn-refresh" onclick="loadData()" id="refreshBtn">
                     Actualizar Datos
                </button>
            </h3>
            
            <div class="data-stats" id="dataStats">
                <strong>Estad铆sticas del Sistema:</strong>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="totalRecords">0</div>
                        <div class="stat-label">Total Registros</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="uniqueStudents">0</div>
                        <div class="stat-label">Estudiantes 煤nicos</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="totalSubjects">0</div>
                        <div class="stat-label">Asignaturas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="lastUpdate">-</div>
                        <div class="stat-label">ltima actualizaci贸n</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="search-section" id="searchSection">
            <div class="search-container">
                <div class="input-group">
                    <label for="cedulaInput">N煤mero de C茅dula:</label>
                    <input type="text" id="cedulaInput" placeholder="Ingrese el n煤mero de c茅dula del estudiante">
                </div>
                <button class="btn" onclick="buscarEstudiante()" id="searchBtn">
                     Buscar Estudiante
                </button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p id="loadingText">Cargando datos desde Google Sheets...</p>
        </div>

        <div class="error-message" id="errorMessage"></div>
        <div class="success-message" id="successMessage"></div>

        <div class="results-section" id="resultsSection">
            <div class="student-info" id="studentInfo">
                <h2> Informaci贸n del Estudiante</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Nombre Completo</div>
                        <div class="info-value" id="studentName">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">C茅dula</div>
                        <div class="info-value" id="studentId">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Subnivel</div>
                        <div class="info-value" id="studentSubnivel">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Curso</div>
                        <div class="info-value" id="studentCurso">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Paralelo</div>
                        <div class="info-value" id="studentParalelo">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Per铆odo Lectivo</div>
                        <div class="info-value" id="studentPeriodo">-</div>
                    </div>
                </div>
            </div>

            <div class="grades-section">
                <h3> Calificaciones por Trimestre</h3>
                <div class="grades-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Asignatura</th>
                                <th>Docente</th>
                                <th>Trimestre 1</th>
                                <th>Trimestre 2</th>
                                <th>Trimestre 3</th>
                                <th>Promedio</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="gradesTableBody">
                            <!-- Los datos se cargar谩n aqu铆 din谩micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- PapaParse para procesar CSV -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="script.js"></script>
</body>
</html>